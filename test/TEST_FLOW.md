# Staking Dapp Test Flow Diagram

## Data Retrieval Flow

```
┌───────────────┐     ┌───────────────┐     ┌───────────────┐
│               │     │               │     │               │
│  Test Runner  │────▶│ Wallet Canister│────▶│  NFT Registry │
│               │     │               │     │               │
└───────────────┘     └───────────────┘     └───────────────┘
        │                     │                     │
        │                     │                     │
        ▼                     ▼                     ▼
┌───────────────┐     ┌───────────────┐     ┌───────────────┐
│               │     │               │     │               │
│ Payout Canister│◀───┤   Holder Data  │◀───┤ Ownership Data │
│               │     │               │     │               │
└───────────────┘     └───────────────┘     └───────────────┘
```

## Reward Calculation Flow

```
┌───────────────┐     ┌───────────────┐     ┌───────────────┐
│               │     │               │     │               │
│  Payout       │────▶│ Holder NFT    │────▶│  Tier         │
│  Canister     │     │ Count         │     │  Calculation  │
│               │     │               │     │               │
└───────────────┘     └───────────────┘     └───────────────┘
        │                                            │
        │                                            │
        ▼                                            ▼
┌───────────────┐     ┌───────────────┐     ┌───────────────┐
│               │     │               │     │               │
│  Network Load │────▶│  Dynamic Fee  │◀────┤  Bonus Rate   │
│  Calculation  │     │  Calculation  │     │  Application  │
│               │     │               │     │               │
└───────────────┘     └───────────────┘     └───────────────┘
                              │
                              │
                              ▼
                      ┌───────────────┐
                      │               │
                      │ Final Reward  │
                      │ Calculation   │
                      │               │
                      └───────────────┘
```

## Reward Delivery Flow

```
┌───────────────┐     ┌───────────────┐     ┌───────────────┐
│               │     │               │     │               │
│  Batch        │────▶│ Process       │────▶│  Transfer     │
│  Creation     │     │ Batch         │     │  Execution    │
│               │     │               │     │               │
└───────────────┘     └───────────────┘     └───────────────┘
                                                    │
                                                    │
         ┌──────────────────────────────────────────┘
         │                    │
         ▼                    ▼
┌───────────────┐     ┌───────────────┐     ┌───────────────┐
│               │     │               │     │               │
│  Success      │     │  Failure      │────▶│  Retry        │
│  Confirmation │     │  Detection    │     │  Mechanism    │
│               │     │               │     │               │
└───────────────┘     └───────────────┘     └───────────────┘
        │                                            │
        │                    ┌─────────────────┐     │
        │                    │                 │     │
        ▼                    ▼                 │     ▼
┌───────────────┐     ┌───────────────┐        │  ┌───────────────┐
│               │     │               │        │  │               │
│ Update Wallet │     │ Update System │◀───────┘  │ Error Logging │
│ Records       │     │ Balance       │           │ & Reporting   │
│               │     │               │           │               │
└───────────────┘     └───────────────┘           └───────────────┘
```

## Complete Test Cycle

```
┌───────────────┐
│               │
│ Initialization│
│               │
└───────────────┘
        │
        ▼
┌───────────────┐
│               │
│ Data Retrieval│
│ Tests         │
│               │
└───────────────┘
        │
        ▼
┌───────────────┐
│               │
│ Reward        │
│ Calculation   │
│ Tests         │
│               │
└───────────────┘
        │
        ▼
┌───────────────┐
│               │
│ Reward        │
│ Delivery      │
│ Tests         │
│               │
└───────────────┘
        │
        ▼
┌───────────────┐
│               │
│ Cross-Canister│
│ Verification  │
│               │
└───────────────┘
        │
        ▼
┌───────────────┐
│               │
│ Performance   │
│ Metrics       │
│ Collection    │
│               │
└───────────────┘
        │
        ▼
┌───────────────┐
│               │
│ Test Report   │
│ Generation    │
│               │
└───────────────┘
``` 